#define REGENERATION_DELAY 60

/datum/species/draugr
	// Spaceproof zombies.
	name = "\improper Draugr"
	id = SPECIES_DRAUGR
	sexes = 0 // if there's no distinction between genders
	icon = 'icons/mobs/human_races/draugr.dmi' // Whatever this path ends up being.
	changesource_flags = MIRROR_BADMIN | WABBAJACK | MIRROR_PRIDE | MIRROR_MAGIC | RACE_SWAP | ERT_SPAWN
	loreblurb = "Some cool lore statement about the species goes here."
	species_traits = list(NOBLOOD,NOZOMBIE,NOTRANSSTING)
	inherent_traits = list(
		TRAIT_NOMETABOLISM,
		TRAIT_TOXIMMUNE,
		TRAIT_RESISTCOLD,
		TRAIT_RESISTLOWPRESSURE,
		TRAIT_RADIMMUNE,
		TRAIT_EASYDISMEMBER,
		TRAIT_LIMBATTACHMENT,
		TRAIT_NOBREATH,
		TRAIT_NODEATH,
		TRAIT_FAKEDEATH,
		TRAIT_NOCLONELOSS,
		TRAIT_SPACEWALK,
		)
	inherent_biotypes = MOB_UNDEAD|MOB_HUMANOID
	liked_food = GROSS | MEAT | RAW
	disliked_food = NONE

	mutanteyes = /obj/item/organ/eyes/night_vision/ // Night vision eyes. We could also customize these further
	mutanttongue = /obj/item/organ/tongue/draugr // Gives them a unique tongue so we can customize say verbs, see the tongue section below
	species_language_holder = /datum/language_holder/draugr

	var/regen_cooldown = 0

	var/static/list/spooks = list(
	'sound/hallucinations/growl1.ogg',
	'sound/hallucinations/growl2.ogg',
	'sound/hallucinations/growl3.ogg',
	'sound/hallucinations/veryfar_noise.ogg',
	'sound/hallucinations/wail.ogg'
	) // Standard zombie noises

	bodytemp_normal = T0C // Body temperature matches the environment
	min_temp_comfortable = 0 // They're comfortable at absolute zero :)
	max_temp_comfortable = 280 // Uncomfortable temp - they don't take damage, but the HUD will warn them it's hot
	bodytemp_cold_damage_limit = 0
	bodytemp_heat_damage_limit = 290 // They start taking damage at slightly below room temperature
	heatmod = 1.5 // = 1.5x heat damage
	burnmod = 1.5 // = 1.5x burn damage

	species_chest = /obj/item/bodypart/chest/draugr
	species_head = /obj/item/bodypart/head/draugr
	species_l_arm = /obj/item/bodypart/l_arm/draugr
	species_r_arm = /obj/item/bodypart/r_arm/draugr
	species_l_leg = /obj/item/bodypart/leg/left/draugr
	species_r_leg = /obj/item/bodypart/leg/right/draugr

/datum/species/draugr/natural_bodytemperature_stabilization(datum/gas_mixture/environment, mob/living/carbon/human/H) // Body temp doesn't stabilize on its own
	return

// Optional stuff from zombies we can tweak or put under an infectious subtype if desired //

/datum/species/draugr/spec_stun(mob/living/carbon/human/H,amount)
	. = min(20, amount) // Reduced stun

/datum/species/draugr/apply_damage(damage, damagetype = BRUTE, def_zone = null, blocked, mob/living/carbon/human/H, forced = FALSE, sharpness = FALSE)
	. = ..()
	if(.)
		regen_cooldown = world.time + REGENERATION_DELAY // Delayed regen, to balance the above

// Languages //

/datum/language_holder/draugr
	understood_languages = list(/datum/language/common = list(LANGUAGE_ATOM),
								/datum/language/calcic = list(LANGUAGE_ATOM)) // Just an example
	spoken_languages = list(/datum/language/common = list(LANGUAGE_ATOM),
							/datum/language/calcic = list(LANGUAGE_ATOM))

// Tongue //

/obj/item/organ/tongue/draugr
	name = "decomposing tongue" // Change this to whatever
	desc = "This tongue is decomposing, which probably renders it substantially less useful."
	icon_state = "tonguedraugr"
	say_mod = "moans"
	modifies_speech = TRUE
	taste_sensitivity = 32

/obj/item/organ/tongue/draugr/handle_speech(datum/source, list/speech_args) // Currently unchanged from zombie speech
	var/list/message_list = splittext(speech_args[SPEECH_MESSAGE], " ")
	var/maxchanges = max(round(message_list.len / 1.5), 2)

	for(var/i = rand(maxchanges / 2, maxchanges), i > 0, i--)
		var/insertpos = rand(1, message_list.len - 1)
		var/inserttext = message_list[insertpos]

		if(!(copytext(inserttext, -3) == "...")) // Randomly inserts ellipses
			message_list[insertpos] = inserttext + "..."

		if(prob(20) && message_list.len > 3)
			message_list.Insert(insertpos, "[pick("BRAINS", "Brains", "Braaaiinnnsss", "BRAAAIIINNSSS")]...") // Randomly inserted phrases go here

	speech_args[SPEECH_MESSAGE] = jointext(message_list, " ")

// Other body parts //

/obj/item/bodypart/head/draugr
	limb_id = "draugr"
	is_dimorphic = FALSE
	should_draw_greyscale = FALSE

/obj/item/bodypart/chest/draugr
	limb_id = "draugr"
	is_dimorphic = FALSE
	should_draw_greyscale = FALSE

/obj/item/bodypart/l_arm/draugr
	limb_id = "draugr"
	should_draw_greyscale = FALSE

/obj/item/bodypart/r_arm/draugr
	limb_id = "draugr"
	should_draw_greyscale = FALSE

/obj/item/bodypart/leg/left/draugr
	limb_id = "draugr"
	should_draw_greyscale = FALSE

/obj/item/bodypart/leg/right/draugr
	limb_id = "draugr"
	should_draw_greyscale = FALSE

#undef REGENERATION_DELAY
