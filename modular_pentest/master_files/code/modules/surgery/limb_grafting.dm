/datum/surgery_step/graft_limb/unconventional
	name = "Limb grafting"
	implements = list(
		/obj/item/bodypart = 100,
		/obj/item/organ_storage = 100,
		/obj/item/chainsaw = 100,
		/obj/item/melee/synthetic_arm_blade = 100,
		/obj/item/gun/ballistic/shotgun/mounted = 100)
	time = 32
	experience_given = MEDICAL_SKILL_ORGAN_FIX

// Grafting override //

/datum/surgery_step/graft_limb/unconventional/success(mob/user, mob/living/carbon/target, target_zone, obj/item/tool, datum/surgery/surgery, default_display_results = FALSE)
	if(medical_malpractice(user, target, target_zone, tool)) // Unconventional grafting
		return

// Medical malpractice <3

/proc/medical_malpractice(mob/user, mob/living/carbon/target, target_zone, obj/item/tool)
	if(istype(tool, /obj/item/chainsaw))
		var/obj/item/mounted_chainsaw/new_arm = new(target, TRUE, TRUE)
		if(target_zone == BODY_ZONE_R_ARM)
			target.put_in_r_hand(new_arm)
		else
			target.put_in_l_hand(new_arm)

		qdel(tool)
		return TRUE

	if(istype(tool, /obj/item/melee/synthetic_arm_blade))
		var/obj/item/melee/arm_blade/new_arm = new(target, TRUE, TRUE)
		if(target_zone == BODY_ZONE_R_ARM)
			target.put_in_r_hand(new_arm)
		else
			target.put_in_l_hand(new_arm)

		qdel(tool)
		return TRUE

	if(istype(tool, /obj/item/gun/ballistic/shotgun/mounted))
		var/obj/item/gun/ballistic/shotgun/mounted/on/new_arm = new(target, TRUE, TRUE)
		if(target_zone == BODY_ZONE_R_ARM)
			target.put_in_r_hand(new_arm)
		else
			target.put_in_l_hand(new_arm)

		qdel(tool)
		return TRUE

	return FALSE

/datum/surgery/limb_grafting/unconventional
	name = "Limb grafting"
	steps = list(
		/datum/surgery_step/incise,
		/datum/surgery_step/clamp_bleeders,
		/datum/surgery_step/retract_skin,
		/datum/surgery_step/graft_limb/unconventional // magical
	)
	target_mobtypes = list(
		/mob/living/carbon/human,
		/mob/living/carbon/monkey,
		/mob/living/silicon
	)
	possible_locs = list(BODY_ZONE_R_ARM, BODY_ZONE_L_ARM, BODY_ZONE_L_LEG, BODY_ZONE_R_LEG, BODY_ZONE_HEAD)
	requires_bodypart = FALSE
	requires_bodypart_type = 0
